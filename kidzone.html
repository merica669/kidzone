<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KidZone.ai - Safe AI Creative Playground for Kids</title>
    <meta name="description" content="A parent-controlled AI environment where children can safely create stories, images, and learn through AI-powered creativity.">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        :root {
            --primary: #6366f1; --primary-dark: #4f46e5; --secondary: #f59e0b;
            --success: #10b981; --danger: #ef4444; --info: #3b82f6;
            --background: #f0f9ff; --surface: #ffffff; --text-primary: #1e293b;
            --text-secondary: #64748b; --border: #e2e8f0;
            --shadow: 0 1px 3px 0 rgb(0 0 0 / 0.1);
            --shadow-lg: 0 10px 25px -5px rgb(0 0 0 / 0.1);
        }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: var(--background);
            color: var(--text-primary);
        }
        .page { display: none; animation: fadeIn 0.3s ease; }
        .page.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        
        /* Parent Onboarding & Dashboard */
        .onboarding-container, .dashboard-container { min-height: 100vh; display: flex; align-items: center; justify-content: center; padding: 20px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); }
        .onboarding-card, .dashboard-card { background: white; border-radius: 24px; padding: 40px; max-width: 600px; width: 100%; box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3); }
        .logo { text-align: center; margin-bottom: 30px; }
        .logo h1 { font-size: 2.5em; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; margin-bottom: 8px; }
        .logo p { color: var(--text-secondary); font-size: 1.1em; }
        .form-group { margin-bottom: 24px; }
        .form-label { display: block; margin-bottom: 8px; font-weight: 600; color: var(--text-primary); }
        .form-input, .form-select { width: 100%; padding: 12px; border: 2px solid var(--border); border-radius: 8px; font-size: 16px; transition: all 0.3s ease; }
        .form-input:focus, .form-select:focus { outline: none; border-color: var(--primary); box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1); }
        .checkbox-group { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 12px; margin-top: 12px; }
        .checkbox-item { display: flex; align-items: center; padding: 10px; background: var(--background); border-radius: 8px; cursor: pointer; transition: background 0.3s ease; }
        .checkbox-item:hover { background: #e0f2fe; }
        .checkbox-item input[type="checkbox"] { margin-right: 8px; width: 18px; height: 18px; cursor: pointer; }
        .btn { padding: 14px 28px; border: none; border-radius: 8px; font-size: 16px; font-weight: 600; cursor: pointer; transition: all 0.3s ease; display: inline-flex; align-items: center; justify-content: center; gap: 8px; }
        .btn-primary { background: var(--primary); color: white; width: 100%; }
        .btn-primary:hover { background: var(--primary-dark); transform: translateY(-2px); box-shadow: var(--shadow-lg); }
        
        /* Child Creative Space */
        .creative-header { background: white; padding: 16px 24px; box-shadow: var(--shadow); position: sticky; top: 0; z-index: 100; display: flex; justify-content: space-between; align-items: center; }
        .child-greeting { font-size: 1.5em; font-weight: 700; color: var(--primary); display: flex; align-items: center; gap: 10px; }
        .header-controls { display: flex; gap: 10px; align-items: center; }
        .coin-counter { background: linear-gradient(135deg, #fbbf24, #f59e0b); color: white; padding: 8px 16px; border-radius: 20px; font-weight: 600; display: flex; align-items: center; gap: 5px; }
        .main-content { min-height: calc(100vh - 80px); background: var(--background); padding: 20px; }
        .webpage-container { max-width: 900px; margin: 0 auto; padding-bottom: 120px; }
        .webpage-block { background: white; border-radius: 16px; padding: 24px; margin-bottom: 20px; box-shadow: var(--shadow); animation: slideUp 0.5s ease; position: relative; overflow: hidden; }
        @keyframes slideUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
        .block-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px; }
        .block-title { font-size: 1.3em; font-weight: 600; color: var(--text-primary); display: flex; align-items: center; gap: 8px; }
        .block-timestamp { color: var(--text-secondary); font-size: 0.9em; }
        .block-content { color: var(--text-primary); line-height: 1.6; }
        .block-content img { max-width: 100%; border-radius: 12px; margin: 16px 0; box-shadow: var(--shadow); }
        .block-actions { margin-top: 16px; display: flex; gap: 10px; }
        .block-action-btn { padding: 6px 12px; background: var(--background); border: 1px solid var(--border); border-radius: 6px; cursor: pointer; transition: all 0.3s ease; font-size: 0.9em; }
        .block-action-btn:hover { background: white; border-color: var(--primary); color: var(--primary); }
        
        /* Input Area */
        .input-area { position: fixed; bottom: 0; left: 0; right: 0; background: white; border-top: 2px solid var(--border); padding: 20px; box-shadow: 0 -10px 30px rgba(0, 0, 0, 0.1); }
        .input-container { max-width: 1000px; margin: 0 auto; }
        .input-controls { display: flex; gap: 12px; align-items: center; }
        .type-selector { padding: 10px 16px; background: var(--background); border: 2px solid var(--border); border-radius: 8px; font-weight: 600; }
        .prompt-input { flex: 1; padding: 12px 16px; border: 2px solid var(--border); border-radius: 8px; font-size: 16px; }
        .create-btn { padding: 12px 24px; background: linear-gradient(135deg, #667eea, #764ba2); color: white; border: none; border-radius: 8px; font-weight: 600; cursor: pointer; }
        .create-btn:disabled { opacity: 0.6; cursor: not-allowed; }
        .loading-state { display: none; text-align: center; margin-top: 12px; } .loading-state.active { display: block; }
        .loading-spinner { display: inline-block; width: 24px; height: 24px; border: 3px solid var(--border); border-top-color: var(--primary); border-radius: 50%; animation: spin 1s linear infinite; margin-right: 10px; vertical-align: middle; }
        @keyframes spin { to { transform: rotate(360deg); } }
        
        /* Empty State */
        .empty-state { text-align: center; padding: 60px 20px; color: var(--text-secondary); }
        .empty-state-icon { font-size: 4em; margin-bottom: 20px; opacity: 0.3; }
        .suggestion-chips { display: flex; gap: 10px; justify-content: center; flex-wrap: wrap; margin-top: 20px; }
        .suggestion-chip { padding: 8px 16px; background: white; border: 2px solid var(--primary); color: var(--primary); border-radius: 20px; cursor: pointer; transition: all 0.3s ease; }
        .suggestion-chip:hover { background: var(--primary); color: white; }
        
        /* Toast */
        .toast { position: fixed; bottom: 120px; right: 20px; color: white; padding: 16px 24px; border-radius: 8px; box-shadow: var(--shadow-lg); transform: translateX(400px); transition: transform 0.3s ease; z-index: 1000; }
        .toast.show { transform: translateX(0); }
        .toast.success { background: var(--success); } .toast.error { background: var(--danger); } .toast.info { background: var(--info); }

        /* Dashboard */
        .stat-cards { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin-bottom: 30px; }
        .stat-card { background: white; padding: 20px; border-radius: 12px; box-shadow: var(--shadow); }
        .stat-value { font-size: 2em; font-weight: 700; color: var(--primary); }
        .stat-label { color: var(--text-secondary); margin-top: 5px; }
        .activity-log { background: white; border-radius: 12px; padding: 20px; box-shadow: var(--shadow); }
        .activity-item { padding: 12px; border-left: 3px solid var(--primary); margin-bottom: 12px; background: var(--background); border-radius: 0 8px 8px 0; }
        .activity-time { font-size: 0.9em; color: var(--text-secondary); }
    </style>
</head>
<body>
    <!-- Parent Onboarding Page -->
    <div id="parentOnboarding" class="page active">
        <div class="onboarding-container">
            <div class="onboarding-card">
                <div class="logo"><h1>üöÄ KidZone.ai</h1><p>Your Child's Safe AI Creative Playground</p></div>
                <form id="onboardingForm">
                    <div class="form-group"><label class="form-label" for="childName">Child's First Name <span style="color:var(--danger)">*</span></label><input type="text" id="childName" class="form-input" placeholder="e.g., Emma" required maxlength="20"></div>
                    <div class="form-group"><label class="form-label" for="childAge">Age Group <span style="color:var(--danger)">*</span></label><select id="childAge" class="form-select" required><option value="">Select age group</option><option value="4-6">4-6 years (Pre-school)</option><option value="7-9">7-9 years (Early Elementary)</option><option value="10-12">10-12 years (Late Elementary)</option></select></div>
                    <div class="form-group"><label class="form-label" for="childInterests">Interests & Hobbies</label><input type="text" id="childInterests" class="form-input" placeholder="e.g., dinosaurs, space, art, music, sports"><small style="color:var(--text-secondary);display:block;margin-top:4px">Separate multiple interests with commas</small></div>
                    <div class="form-group"><label class="form-label">Safety Settings <span style="color:var(--danger)">*</span></label><div class="checkbox-group"><label class="checkbox-item"><input type="checkbox" value="no-violence" checked><span>No Violence/Scary Content</span></label><label class="checkbox-item"><input type="checkbox" value="positive-only" checked><span>Positive Language Only</span></label><label class="checkbox-item"><input type="checkbox" value="educational" checked><span>Educational Focus</span></label><label class="checkbox-item"><input type="checkbox" value="no-social"><span>No Social Media Topics</span></label></div></div>
                    <button type="submit" class="btn btn-primary"><span>üé®</span><span>Start Creative Session</span></button>
                </form>
            </div>
        </div>
    </div>
    
    <!-- Child Creative Space -->
    <div id="childCreativeSpace" class="page">
        <header class="creative-header"><div class="child-greeting"><span class="welcome-emoji">üëã</span><span id="childGreetingText">Welcome!</span></div><div class="header-controls"><div class="coin-counter"><span>‚≠ê</span><span id="creativityCoins">0</span><span>Stars</span></div><button class="btn btn-secondary" onclick="showParentDashboard()" style="background-color: #e2e8f0; color: #475569;">Parent View</button></div></header>
        <main class="main-content"><div class="webpage-container" id="webpageContainer"><div class="empty-state" id="emptyState"><div class="empty-state-icon">üé®</div><h2>Ready to Create Something Amazing?</h2><p>Ask the AI to help you create stories, draw pictures, or learn fun facts!</p><div class="suggestion-chips"><div class="suggestion-chip" onclick="useSuggestion('Tell me a story about a friendly dragon')">üêâ Dragon Story</div><div class="suggestion-chip" onclick="useSuggestion('Draw a magical rainbow castle')">üè∞ Magic Castle</div><div class="suggestion-chip" onclick="useSuggestion('Fun facts about planets')">ü™ê Space Facts</div><div class="suggestion-chip" onclick="useSuggestion('Write a poem about butterflies')">ü¶ã Butterfly Poem</div></div></div></div></main>
        <div class="input-area"><div class="input-container"><div class="input-controls"><select id="blockType" class="type-selector"><option value="story">üìñ Story</option><option value="image">üé® Picture</option><option value="fact">üí° Fun Fact</option><option value="quiz">‚ùì Quiz</option><option value="poem">‚ú® Poem</option></select><input type="text" id="promptInput" class="prompt-input" placeholder="What should we create today?" maxlength="200"><button id="createBtn" class="create-btn" onclick="handlePrompt()">Create Magic! ‚ú®</button></div><div id="loadingState" class="loading-state"><span class="loading-spinner"></span><span class="loading-message">Our Guardian AI is making your idea safe and amazing...</span></div></div></div>
    </div>
    
    <!-- Parent Dashboard -->
    <div id="parentDashboard" class="page">
        <div class="dashboard-container">
            <div class="dashboard-card">
                 <div class="logo"><h1>Parent Dashboard</h1></div>
                 <div class="stat-cards"><div class="stat-card"><div class="stat-value" id="totalCreations">0</div><div class="stat-label">Total Creations</div></div><div class="stat-card"><div class="stat-value" id="safetyBlocks">0</div><div class="stat-label">Safety Filters Applied</div></div><div class="stat-card"><div class="stat-value" id="creativityScore">0</div><div class="stat-label">Creativity Stars</div></div><div class="stat-card"><div class="stat-value" id="sessionTime">0m</div><div class="stat-label">Session Time</div></div></div>
                 <div class="activity-log"><h2 style="margin-bottom:20px;color:var(--text-primary)">Recent Activity</h2><div id="activityLog"><p style="color:var(--text-secondary)">No activity yet. Start creating to see the log!</p></div></div>
                 <button class="btn btn-primary" onclick="showChildSpace()" style="width:auto;margin-top:24px">Back to Creative Space</button>
            </div>
        </div>
    </div>
    
    <div id="toast" class="toast"></div>
    
    <script>
        // ===========================
        // CONFIGURATION
        // ===========================
        const API_KEY = "AIzaSyDkBHWGERIoYNeK00O_n15Uj76KEzNvpAE"; // PASTE YOUR GEMINI API KEY HERE
        
        // ===========================
        // GLOBAL STATE & INITIALIZATION
        // ===========================
        let childProfile = {};
        let stats = { totalCreations: 0, safetyBlocks: 0, creativityCoins: 0, sessionStart: Date.now(), activityLog: [] };
        
        document.addEventListener('DOMContentLoaded', () => {
            const savedProfile = localStorage.getItem('kidzoneProfile');
            if (savedProfile) {
                childProfile = JSON.parse(savedProfile);
                const savedStats = localStorage.getItem('kidzoneStats');
                if (savedStats) stats = JSON.parse(savedStats);
                showChildSpace();
            }
            document.getElementById('onboardingForm').addEventListener('submit', handleOnboarding);
            document.getElementById('promptInput')?.addEventListener('keypress', (e) => { if (e.key === 'Enter') { e.preventDefault(); handlePrompt(); } });
        });
        
        // ===========================
        // PAGE NAVIGATION & UI UPDATES
        // ===========================
        function showPage(pageId) {
            document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
            document.getElementById(pageId).classList.add('active');
        }
        window.showChildSpace = () => { showPage('childCreativeSpace'); updateChildGreeting(); updateStats(); };
        window.showParentDashboard = () => { showPage('parentDashboard'); updateDashboardStats(); };
        function updateChildGreeting() {
            const hour = new Date().getHours();
            const timeOfDay = hour < 12 ? 'Good morning' : hour < 17 ? 'Good afternoon' : 'Good evening';
            document.getElementById('childGreetingText').textContent = `${timeOfDay}, ${childProfile.name}!`;
        }
        function updateStats() { document.getElementById('creativityCoins').textContent = stats.creativityCoins; }
        function updateDashboardStats() {
            document.getElementById('totalCreations').textContent = stats.totalCreations;
            document.getElementById('safetyBlocks').textContent = stats.safetyBlocks;
            document.getElementById('creativityScore').textContent = stats.creativityCoins;
            document.getElementById('sessionTime').textContent = `${Math.floor((Date.now() - stats.sessionStart) / 60000)}m`;
            const logContainer = document.getElementById('activityLog');
            if (stats.activityLog.length > 0) {
                logContainer.innerHTML = stats.activityLog.slice(-10).reverse().map(item => `<div class="activity-item"><div><strong>${item.type}</strong>: ${item.prompt}</div><div class="activity-time">${new Date(item.timestamp).toLocaleTimeString()}</div></div>`).join('');
            } else {
                logContainer.innerHTML = `<p style="color: var(--text-secondary);">No activity yet.</p>`;
            }
        }
        
        // ===========================
        // ONBOARDING
        // ===========================
        function handleOnboarding(e) {
            e.preventDefault();
            const name = document.getElementById('childName').value.trim();
            const age = document.getElementById('childAge').value;
            if (!name || !age) { showToast('Please fill in all required fields', 'error'); return; }
            
            const guardrails = [];
            document.querySelectorAll('.checkbox-item input:checked').forEach(cb => guardrails.push(cb.value));
            
            childProfile = { name, age, interests: document.getElementById('childInterests').value.trim(), guardrails };
            stats = { totalCreations: 0, safetyBlocks: 0, creativityCoins: 0, sessionStart: Date.now(), activityLog: [] };
            
            localStorage.setItem('kidzoneProfile', JSON.stringify(childProfile));
            localStorage.setItem('kidzoneStats', JSON.stringify(stats));
            
            showChildSpace();
            showToast(`Welcome, ${name}! Let's create something amazing! üéâ`, 'success');
        }

        // ===========================
        // CORE AI PIPELINE
        // ===========================
        async function handlePrompt() {
            const rawPrompt = document.getElementById('promptInput').value.trim();
            const blockType = document.getElementById('blockType').value;
            if (!rawPrompt) { showToast('Please type your idea first!', 'info'); return; }
            if (!API_KEY) { showToast('API Key not configured. Please ask a parent to set it up.', 'error'); return; }

            document.getElementById('loadingState').classList.add('active');
            document.getElementById('createBtn').disabled = true;

            try {
                // Step 1: Guardian AI rewrites the prompt
                const rewrittenPrompt = await getRewrittenPrompt(rawPrompt, blockType);
                if (!rewrittenPrompt) throw new Error("Guardian AI failed to generate a safe prompt.");
                if (rawPrompt.toLowerCase() !== rewrittenPrompt.toLowerCase()) stats.safetyBlocks++;
                
                // Step 2: Core AI generates content
                let content;
                if (blockType === 'image') {
                    content = await generateImage(rewrittenPrompt);
                } else {
                    content = await generateTextContent(rewrittenPrompt, blockType);
                }
                
                // Step 3: Update UI
                addBlockToWebpage(blockType, content, rawPrompt);
                updateStatsAndLog(blockType, rawPrompt);
                document.getElementById('promptInput').value = '';
                showToast('Amazing creation added! You earned 10 stars! ‚≠ê', 'success');

            } catch (error) {
                console.error('Error:', error);
                showToast('Oops! The AI is sleeping. Let\'s try another idea!', 'error');
            } finally {
                document.getElementById('loadingState').classList.remove('active');
                document.getElementById('createBtn').disabled = false;
            }
        }

        function updateStatsAndLog(type, prompt) {
            stats.totalCreations++;
            stats.creativityCoins += 10;
            stats.activityLog.push({ type, prompt, timestamp: Date.now() });
            localStorage.setItem('kidzoneStats', JSON.stringify(stats));
            updateStats();
        }

        // --- GEMINI API CALLS ---
        async function getRewrittenPrompt(rawPrompt, blockType) {
            const systemInstruction = `You are a "Guardian AI" prompt engineer. Rewrite a child's raw prompt into a safe, detailed, and creative new prompt for another AI, strictly adhering to the parent-defined profile.
            - Child's Profile: ${JSON.stringify(childProfile)}
            - Your task is to transform the child's raw prompt into a new, safe prompt incorporating their age, interests, and all safety guardrails. The new prompt must be wholesome, creative, and strictly age-appropriate.
            - If the request is for an image, the rewritten prompt must be a highly descriptive, safe-for-kids image generation prompt.
            - Respond with ONLY the rewritten prompt.`;
            
            return await callGeminiAPI(systemInstruction, `Child's raw prompt: "${rawPrompt}"`);
        }
        
        async function generateTextContent(rewrittenPrompt, blockType) {
            const typeInstructions = {
                story: 'Create a short, engaging story (3-4 paragraphs).',
                fact: 'Share 3-5 amazing, kid-friendly facts.',
                quiz: 'Create 3 fun multiple-choice questions with answers clearly marked.',
                poem: 'Write a cheerful, rhyming poem (8-12 lines).'
            };
            const systemInstruction = `You are a fun and creative AI for children. Generate content that is strictly aligned with the user's detailed prompt, which has been pre-screened for safety. Your response must be engaging and perfectly age-appropriate. Format your response with simple HTML paragraphs and basic formatting like <strong> for emphasis. For quizzes, wrap the correct answer in a <strong> tag.`;
            
            return await callGeminiAPI(systemInstruction, rewrittenPrompt);
        }

        async function generateImage(rewrittenPrompt) {
            const payload = { instances: [{ prompt: rewrittenPrompt }], parameters: { "sampleCount": 1 } };
            const API_URL = `https://generativelanguage.googleapis.com/v1beta/models/imagen-3.0-generate-002:predict?key=${API_KEY}`;
            const response = await fetch(API_URL, { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify(payload) });
            if (!response.ok) throw new Error(`Imagen API Error: ${response.statusText}`);
            const result = await response.json();
            if (result.predictions?.[0]?.bytesBase64Encoded) {
                return `<img src="data:image/png;base64,${result.predictions[0].bytesBase64Encoded}" class="rounded-lg shadow-md" alt="AI generated image of: ${rewrittenPrompt}">`;
            }
            throw new Error("Image generation failed to return data.");
        }

        async function callGeminiAPI(system, userPrompt, retryCount = 3, delay = 1000) {
            const API_URL = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=${API_KEY}`;
            const payload = {
                systemInstruction: { parts: [{ text: system }] },
                contents: [{ parts: [{ text: userPrompt }] }],
                generationConfig: { temperature: 0.7, maxOutputTokens: 1024 }
            };
            try {
                const response = await fetch(API_URL, { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify(payload) });
                if (!response.ok) {
                    if (response.status === 429 && retryCount > 0) {
                        await new Promise(res => setTimeout(res, delay));
                        return callGeminiAPI(system, userPrompt, retryCount - 1, delay * 2);
                    } throw new Error(`API Error: ${response.statusText}`);
                }
                const data = await response.json();
                return data.candidates?.[0]?.content?.parts?.[0]?.text;
            } catch (error) { console.error("API Call failed:", error); return null; }
        }

        // --- WEBPAGE & HELPER FUNCTIONS ---
        function addBlockToWebpage(type, content, originalPrompt) {
            document.getElementById('emptyState').style.display = 'none';
            const container = document.getElementById('webpageContainer');
            const block = document.createElement('div');
            block.className = 'webpage-block';
            const icons={'story':'üìñ','image':'üé®','fact':'üí°','quiz':'‚ùì','poem':'‚ú®'};
            const colors={'story':'story','image':'image','fact':'fact','quiz':'quiz','poem':'poem'};
            const title = originalPrompt.length > 30 ? originalPrompt.substring(0, 30) + '...' : originalPrompt;
            block.innerHTML = `<div class="block-header"><div class="block-title"><div class="block-type-icon block-type-${colors[type]}" style="background:var(--${colors[type]}-grad, #ccc); color:white;">${icons[type]}</div><span>${title.charAt(0).toUpperCase() + title.slice(1)}</span></div><div class="block-timestamp">${new Date().toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'})}</div></div><div class="block-content">${content}</div><div class="block-actions"><button class="block-action-btn" onclick="readAloud(this)">üîä Read Aloud</button><button class="block-action-btn" onclick="deleteBlock(this)">üóëÔ∏è Delete</button></div>`;
            container.appendChild(block);
            block.scrollIntoView({ behavior: 'smooth', block: 'end' });
        }
        window.useSuggestion = (suggestion) => { const input = document.getElementById('promptInput'); input.value = suggestion; input.focus(); };
        window.readAloud = (btn) => {
            const text = btn.closest('.webpage-block').querySelector('.block-content').textContent;
            speechSynthesis.speak(new SpeechSynthesisUtterance(text));
            showToast('Reading aloud... üîä', 'info');
        };
        window.deleteBlock = (btn) => {
            if (confirm('Are you sure you want to delete this creation?')) {
                btn.closest('.webpage-block').remove();
                stats.totalCreations = Math.max(0, stats.totalCreations - 1);
                localStorage.setItem('kidzoneStats', JSON.stringify(stats));
                if (document.querySelectorAll('.webpage-block').length === 0) {
                    document.getElementById('emptyState').style.display = 'block';
                }
            }
        };
        function showToast(message, type = 'info') {
            const toast = document.getElementById('toast');
            toast.textContent = message;
            toast.className = `toast ${type} show`;
            setTimeout(() => { toast.classList.remove('show'); }, 3000);
        }
    </script>
</body>
</html>
